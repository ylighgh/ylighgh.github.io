import{c as a}from"./app.9036987c.js";import{_ as s}from"./plugin-vue_export-helper.21dcd24c.js";var e="/blog/img/in-post/2022-06-25/redis_01.png",n="/blog/img/in-post/2022-06-25/redis_02.png",r="/blog/img/in-post/2022-06-25/redis_03.png";const d={},c=a('<h2 id="redis\u5206\u5E03\u5F0F\u5B58\u50A8" tabindex="-1"><a class="header-anchor" href="#redis\u5206\u5E03\u5F0F\u5B58\u50A8" aria-hidden="true">#</a> redis\u5206\u5E03\u5F0F\u5B58\u50A8</h2><p>\u67B6\u6784\u56FE</p><p><img src="'+e+`" alt="redis_01"></p><h3 id="\u54C8\u5E0C\u53D6\u4F59\u7B97\u6CD5" tabindex="-1"><a class="header-anchor" href="#\u54C8\u5E0C\u53D6\u4F59\u7B97\u6CD5" aria-hidden="true">#</a> \u54C8\u5E0C\u53D6\u4F59\u7B97\u6CD5</h3><h3 id="\u4E00\u81F4\u6027\u54C8\u5E0C\u7B97\u6CD5" tabindex="-1"><a class="header-anchor" href="#\u4E00\u81F4\u6027\u54C8\u5E0C\u7B97\u6CD5" aria-hidden="true">#</a> \u4E00\u81F4\u6027\u54C8\u5E0C\u7B97\u6CD5</h3><h3 id="\u54C8\u5E0C\u69FD\u7B97\u6CD5" tabindex="-1"><a class="header-anchor" href="#\u54C8\u5E0C\u69FD\u7B97\u6CD5" aria-hidden="true">#</a> \u54C8\u5E0C\u69FD\u7B97\u6CD5</h3><h2 id="_3\u4E3B3\u4ECEredis\u96C6\u7FA4\u914D\u7F6E" tabindex="-1"><a class="header-anchor" href="#_3\u4E3B3\u4ECEredis\u96C6\u7FA4\u914D\u7F6E" aria-hidden="true">#</a> 3\u4E3B3\u4ECEredis\u96C6\u7FA4\u914D\u7F6E</h2><h3 id="\u542F\u52A8redis" tabindex="-1"><a class="header-anchor" href="#\u542F\u52A8redis" aria-hidden="true">#</a> \u542F\u52A8redis</h3><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token function">docker</span> run -d --name redis-node-1 --net <span class="token function">host</span> --privileged<span class="token operator">=</span>true -v /data/redis/share/redis-node-1:/data redis:6.0.8 --cluster-enabled <span class="token function">yes</span> --appendonly <span class="token function">yes</span> --port <span class="token number">6381</span>

<span class="token function">docker</span> run -d --name redis-node-2 --net <span class="token function">host</span> --privileged<span class="token operator">=</span>true -v /data/redis/share/redis-node-2:/data redis:6.0.8 --cluster-enabled <span class="token function">yes</span> --appendonly <span class="token function">yes</span> --port <span class="token number">6382</span>

<span class="token function">docker</span> run -d --name redis-node-3 --net <span class="token function">host</span> --privileged<span class="token operator">=</span>true -v /data/redis/share/redis-node-3:/data redis:6.0.8 --cluster-enabled <span class="token function">yes</span> --appendonly <span class="token function">yes</span> --port <span class="token number">6383</span>

<span class="token function">docker</span> run -d --name redis-node-4 --net <span class="token function">host</span> --privileged<span class="token operator">=</span>true -v /data/redis/share/redis-node-4:/data redis:6.0.8 --cluster-enabled <span class="token function">yes</span> --appendonly <span class="token function">yes</span> --port <span class="token number">6384</span>

<span class="token function">docker</span> run -d --name redis-node-5 --net <span class="token function">host</span> --privileged<span class="token operator">=</span>true -v /data/redis/share/redis-node-5:/data redis:6.0.8 --cluster-enabled <span class="token function">yes</span> --appendonly <span class="token function">yes</span> --port <span class="token number">6385</span>

<span class="token function">docker</span> run -d --name redis-node-6 --net <span class="token function">host</span> --privileged<span class="token operator">=</span>true -v /data/redis/share/redis-node-6:/data redis:6.0.8 --cluster-enabled <span class="token function">yes</span> --appendonly <span class="token function">yes</span> --port <span class="token number">6386</span>
</code></pre></div><h3 id="\u6784\u5EFA\u4E3B\u4ECE\u5173\u7CFB" tabindex="-1"><a class="header-anchor" href="#\u6784\u5EFA\u4E3B\u4ECE\u5173\u7CFB" aria-hidden="true">#</a> \u6784\u5EFA\u4E3B\u4ECE\u5173\u7CFB</h3><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token comment"># \u8FDB\u5165docker\u5BB9\u5668</span>
<span class="token function">docker</span> <span class="token builtin class-name">exec</span> -it redis-node-1 <span class="token function">bash</span>

<span class="token comment"># \u6267\u884C\u547D\u4EE4 (--cluster-replicas 1 \u4E3A\u6BCF\u4E2Amaster\u521B\u5EFA\u4E00\u4E2Aslave\u8282\u70B9)</span>
redis-cli --cluster create <span class="token number">192.168</span>.43.205:6381 <span class="token number">192.168</span>.43.205:6382 <span class="token number">192.168</span>.43.205:6383 <span class="token number">192.168</span>.43.205:6384 <span class="token number">192.168</span>.43.205:6385 <span class="token number">192.168</span>.43.205:6386 --cluster-replicas <span class="token number">1</span>
</code></pre></div><h3 id="\u67E5\u770B\u96C6\u7FA4\u72B6\u6001" tabindex="-1"><a class="header-anchor" href="#\u67E5\u770B\u96C6\u7FA4\u72B6\u6001" aria-hidden="true">#</a> \u67E5\u770B\u96C6\u7FA4\u72B6\u6001</h3><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token comment"># \u96C6\u7FA4\u72B6\u6001</span>
cluster info

<span class="token comment"># \u96C6\u7FA4\u8282\u70B9</span>
cluster nodes
</code></pre></div><h2 id="\u4E3B\u4ECE\u5BB9\u9519\u5207\u6362\u8FC1\u79FB" tabindex="-1"><a class="header-anchor" href="#\u4E3B\u4ECE\u5BB9\u9519\u5207\u6362\u8FC1\u79FB" aria-hidden="true">#</a> \u4E3B\u4ECE\u5BB9\u9519\u5207\u6362\u8FC1\u79FB</h2><h3 id="\u6570\u636E\u8BFB\u5199\u5B58\u50A8" tabindex="-1"><a class="header-anchor" href="#\u6570\u636E\u8BFB\u5199\u5B58\u50A8" aria-hidden="true">#</a> \u6570\u636E\u8BFB\u5199\u5B58\u50A8</h3><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token comment"># \u8FDB\u5165\u52306381\u8282\u70B9</span>
<span class="token function">docker</span> <span class="token builtin class-name">exec</span> -it redis-node-1 <span class="token function">bash</span>

<span class="token comment"># \u52A0\u5165-c\u53C2\u6570\u8BF4\u660E\u4EE5\u96C6\u7FA4\u65B9\u5F0F\u8FDE\u63A5(\u4F18\u5316\u8DEF\u7531)</span>
redis-cli -p <span class="token number">6381</span> -c
</code></pre></div><h3 id="\u67E5\u770B\u96C6\u7FA4\u4FE1\u606F" tabindex="-1"><a class="header-anchor" href="#\u67E5\u770B\u96C6\u7FA4\u4FE1\u606F" aria-hidden="true">#</a> \u67E5\u770B\u96C6\u7FA4\u4FE1\u606F</h3><div class="language-bash ext-sh"><pre class="language-bash"><code>redis-cli --cluster check <span class="token number">192.168</span>.43.205:6381
</code></pre></div><h3 id="\u4E3B\u4ECE\u5207\u6362" tabindex="-1"><a class="header-anchor" href="#\u4E3B\u4ECE\u5207\u6362" aria-hidden="true">#</a> \u4E3B\u4ECE\u5207\u6362</h3><div class="language-bash ext-sh"><pre class="language-bash"><code>\u5F53\u4E3B\u8282\u70B9\u6302\u6389\u4E4B\u540E,\u4ECE\u8282\u70B9\u4F1A\u81EA\u52A8\u6210\u4E3A\u4E3B\u8282\u70B9

\u4F46\u662F\u5C06\u4E3B\u8282\u70B9\u6062\u590D\u6B63\u5E38\u4E4B\u540E,\u4ECE\u8282\u70B9\u4ECD\u7136\u662F\u4E3B\u8282\u70B9

\u5982\u679C\u9700\u8981\u5C06\u4ECE\u8282\u70B9\u6062\u590D\u81F3\u4ECE\u8282\u70B9,\u5219\u9700\u8981\u624B\u52A8\u5C06\u4ECE\u8282\u70B9\u91CD\u542F
</code></pre></div><h2 id="\u4E3B\u4ECE\u6269\u5BB9" tabindex="-1"><a class="header-anchor" href="#\u4E3B\u4ECE\u6269\u5BB9" aria-hidden="true">#</a> \u4E3B\u4ECE\u6269\u5BB9</h2><p>\u67B6\u6784\u56FE</p><p><img src="`+n+`" alt="redis_02"></p><h3 id="\u589E\u52A0\u4E24\u53F0redis" tabindex="-1"><a class="header-anchor" href="#\u589E\u52A0\u4E24\u53F0redis" aria-hidden="true">#</a> \u589E\u52A0\u4E24\u53F0redis</h3><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token function">docker</span> run -d --name redis-node-7 --net <span class="token function">host</span> --privileged<span class="token operator">=</span>true -v /data/redis/share/redis-node-7:/data redis:6.0.8 --cluster-enabled <span class="token function">yes</span> --appendonly <span class="token function">yes</span> --port <span class="token number">6387</span>

<span class="token function">docker</span> run -d --name redis-node-8 --net <span class="token function">host</span> --privileged<span class="token operator">=</span>true -v /data/redis/share/redis-node-8:/data redis:6.0.8 --cluster-enabled <span class="token function">yes</span> --appendonly <span class="token function">yes</span> --port <span class="token number">6388</span>
</code></pre></div><h3 id="\u5C06\u65B0\u589Emaster\u8282\u70B9\u52A0\u5165\u539F\u96C6\u7FA4" tabindex="-1"><a class="header-anchor" href="#\u5C06\u65B0\u589Emaster\u8282\u70B9\u52A0\u5165\u539F\u96C6\u7FA4" aria-hidden="true">#</a> \u5C06\u65B0\u589Emaster\u8282\u70B9\u52A0\u5165\u539F\u96C6\u7FA4</h3><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token comment"># \u8FDB\u5165node7</span>
<span class="token function">docker</span> <span class="token builtin class-name">exec</span> -it redis-node-7 <span class="token function">bash</span>

<span class="token comment"># \u52A0\u5165\u539F\u96C6\u7FA4</span>
redis-cli --cluster add-node <span class="token number">192.168</span>.43.205:6387: <span class="token number">192.168</span>.43.205:6381
</code></pre></div><h3 id="\u91CD\u65B0\u5206\u914D\u69FD\u53F7" tabindex="-1"><a class="header-anchor" href="#\u91CD\u65B0\u5206\u914D\u69FD\u53F7" aria-hidden="true">#</a> \u91CD\u65B0\u5206\u914D\u69FD\u53F7</h3><div class="language-bash ext-sh"><pre class="language-bash"><code>redis-cli --cluster reshard <span class="token number">192.168</span>.43.205:6381
</code></pre></div><h3 id="\u68C0\u67E5\u96C6\u7FA4\u60C5\u51B5" tabindex="-1"><a class="header-anchor" href="#\u68C0\u67E5\u96C6\u7FA4\u60C5\u51B5" aria-hidden="true">#</a> \u68C0\u67E5\u96C6\u7FA4\u60C5\u51B5</h3><div class="language-bash ext-sh"><pre class="language-bash"><code>redis-cli --cluster check <span class="token number">192.168</span>.43.205:6381
</code></pre></div><h3 id="\u4E3A\u4E3B\u8282\u70B96387\u5206\u914D\u4ECE\u8282\u70B96388" tabindex="-1"><a class="header-anchor" href="#\u4E3A\u4E3B\u8282\u70B96387\u5206\u914D\u4ECE\u8282\u70B96388" aria-hidden="true">#</a> \u4E3A\u4E3B\u8282\u70B96387\u5206\u914D\u4ECE\u8282\u70B96388</h3><div class="language-bash ext-sh"><pre class="language-bash"><code>redis-cli --cluster add-node <span class="token number">192.168</span>.43.205:6388 <span class="token number">192.168</span>.43.205:6387 --cluster-slave --cluster-master-id master\u8282\u70B9\u7684ID
</code></pre></div><h2 id="\u4E3B\u4ECE\u7F29\u5BB9" tabindex="-1"><a class="header-anchor" href="#\u4E3B\u4ECE\u7F29\u5BB9" aria-hidden="true">#</a> \u4E3B\u4ECE\u7F29\u5BB9</h2><p>\u5220\u96646387\u548C6388 \u6062\u590D\u4E4B\u524D\u7684\u4E09\u4E3B\u4E09\u4ECE\u6A21\u5F0F</p><h3 id="\u5220\u96646388\u4ECE\u8282\u70B9" tabindex="-1"><a class="header-anchor" href="#\u5220\u96646388\u4ECE\u8282\u70B9" aria-hidden="true">#</a> \u5220\u96646388\u4ECE\u8282\u70B9</h3><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token comment"># \u83B7\u53D66388\u4ECE\u8282\u70B9ID</span>
redis-cli --cluster check <span class="token number">192.168</span>.43.205:6381

<span class="token comment"># \u5220\u96646388\u4ECE\u8282\u70B9</span>
redis-cli --cluster del-node <span class="token number">192.168</span>.43.205:6388 0c4824ab3ae11a430e1be746e578eb48497117da
</code></pre></div><h3 id="\u6E05\u96646387\u7684\u69FD\u53F7" tabindex="-1"><a class="header-anchor" href="#\u6E05\u96646387\u7684\u69FD\u53F7" aria-hidden="true">#</a> \u6E05\u96646387\u7684\u69FD\u53F7</h3><div class="language-bash ext-sh"><pre class="language-bash"><code>redis-cli --cluster reshard <span class="token number">192.168</span>.43.205:6381

redis-cli --cluster check <span class="token number">192.168</span>.43.205:6381
</code></pre></div><p><img src="`+r+`" alt="redis_03"></p><h3 id="\u5220\u96646387\u8282\u70B9" tabindex="-1"><a class="header-anchor" href="#\u5220\u96646387\u8282\u70B9" aria-hidden="true">#</a> \u5220\u96646387\u8282\u70B9</h3><div class="language-bash ext-sh"><pre class="language-bash"><code>redis-cli --cluster del-node <span class="token number">192.168</span>.43.205:6367 6387ID\u53F7

redis-cli --cluster check <span class="token number">192.168</span>.43.205:6381
</code></pre></div>`,42);function t(o,i){return c}var h=s(d,[["render",t]]);export{h as default};
